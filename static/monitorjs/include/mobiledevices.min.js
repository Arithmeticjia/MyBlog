(function(document){window.MBP=window.MBP||{};MBP.viewportmeta=document.querySelector&&document.querySelector('meta[name="viewport"]');MBP.ua=navigator.userAgent;MBP.scaleFix=function(){if(MBP.viewportmeta&&/iPhone|iPad|iPod/.test(MBP.ua)&&!/Opera Mini/.test(MBP.ua)){MBP.viewportmeta.content="width=device-width, minimum-scale=1.0, maximum-scale=1.0";document.addEventListener("gesturestart",MBP.gestureStart,false)}};MBP.gestureStart=function(){MBP.viewportmeta.content="width=device-width, minimum-scale=0.25, maximum-scale=1.6"};MBP.BODY_SCROLL_TOP=false;MBP.getScrollTop=function(){var win=window;var doc=document;return win.pageYOffset||doc.compatMode==="CSS1Compat"&&doc.documentElement.scrollTop||doc.body.scrollTop||0};MBP.hideUrlBar=function(){var win=window;if(!location.hash&&MBP.BODY_SCROLL_TOP!==false){win.scrollTo(0,MBP.BODY_SCROLL_TOP===1?0:1)}};MBP.hideUrlBarOnLoad=function(){var win=window;var doc=win.document;var bodycheck;if(!location.hash&&win.addEventListener){window.scrollTo(0,1);MBP.BODY_SCROLL_TOP=1;bodycheck=setInterval(function(){if(doc.body){clearInterval(bodycheck);MBP.BODY_SCROLL_TOP=MBP.getScrollTop();MBP.hideUrlBar()}},15);win.addEventListener("load",function(){setTimeout(function(){if(MBP.getScrollTop()<20){MBP.hideUrlBar()}},0)})}};MBP.fastButton=function(element,handler,pressedClass){this.handler=handler;this.pressedClass=typeof pressedClass==="undefined"?"pressed":pressedClass;if(element.length&&element.length>1){for(var singleElIdx in element){this.addClickEvent(element[singleElIdx])}}else{this.addClickEvent(element)}};MBP.fastButton.prototype.handleEvent=function(event){event=event||window.event;switch(event.type){case"touchstart":this.onTouchStart(event);break;case"touchmove":this.onTouchMove(event);break;case"touchend":this.onClick(event);break;case"click":this.onClick(event);break}};MBP.fastButton.prototype.onTouchStart=function(event){var element=event.target||event.srcElement;event.stopPropagation();element.addEventListener("touchend",this,false);document.body.addEventListener("touchmove",this,false);this.startX=event.touches[0].clientX;this.startY=event.touches[0].clientY;element.className+=" "+this.pressedClass};MBP.fastButton.prototype.onTouchMove=function(event){if(Math.abs(event.touches[0].clientX-this.startX)>10||Math.abs(event.touches[0].clientY-this.startY)>10){this.reset(event)}};MBP.fastButton.prototype.onClick=function(event){event=event||window.event;var element=event.target||event.srcElement;if(event.stopPropagation){event.stopPropagation()}this.reset(event);this.handler.apply(event.currentTarget,[event]);if(event.type=="touchend"){MBP.preventGhostClick(this.startX,this.startY)}var pattern=new RegExp(" ?"+this.pressedClass,"gi");element.className=element.className.replace(pattern,"")};MBP.fastButton.prototype.reset=function(event){var element=event.target||event.srcElement;rmEvt(element,"touchend",this,false);rmEvt(document.body,"touchmove",this,false);var pattern=new RegExp(" ?"+this.pressedClass,"gi");element.className=element.className.replace(pattern,"")};MBP.fastButton.prototype.addClickEvent=function(element){addEvt(element,"touchstart",this,false);addEvt(element,"click",this,false)};MBP.preventGhostClick=function(x,y){MBP.coords.push(x,y);window.setTimeout(function(){MBP.coords.splice(0,2)},2500)};MBP.ghostClickHandler=function(event){if(!MBP.hadTouchEvent&&MBP.dodgyAndroid){event.stopPropagation();event.preventDefault();return}for(var i=0,len=MBP.coords.length;i<len;i+=2){var x=MBP.coords[i];var y=MBP.coords[i+1];if(Math.abs(event.clientX-x)<25&&Math.abs(event.clientY-y)<25){event.stopPropagation();event.preventDefault()}}};MBP.dodgyAndroid=("ontouchstart" in window)&&(navigator.userAgent.indexOf("Android 2.3")!=-1);if(document.addEventListener){document.addEventListener("click",MBP.ghostClickHandler,true)}addEvt(document.documentElement,"touchstart",function(){MBP.hadTouchEvent=true},false);MBP.coords=[];function addEvt(el,evt,fn,bubble){if("addEventListener" in el){try{el.addEventListener(evt,fn,bubble)}catch(e){if(typeof fn=="object"&&fn.handleEvent){el.addEventListener(evt,function(e){fn.handleEvent.call(fn,e)},bubble)}else{throw e}}}else{if("attachEvent" in el){if(typeof fn=="object"&&fn.handleEvent){el.attachEvent("on"+evt,function(){fn.handleEvent.call(fn)})}else{el.attachEvent("on"+evt,fn)}}}}function rmEvt(el,evt,fn,bubble){if("removeEventListener" in el){try{el.removeEventListener(evt,fn,bubble)}catch(e){if(typeof fn=="object"&&fn.handleEvent){el.removeEventListener(evt,function(e){fn.handleEvent.call(fn,e)},bubble)}else{throw e}}}else{if("detachEvent" in el){if(typeof fn=="object"&&fn.handleEvent){el.detachEvent("on"+evt,function(){fn.handleEvent.call(fn)})}else{el.detachEvent("on"+evt,fn)}}}}MBP.autogrow=function(element,lh){function handler(e){var newHeight=this.scrollHeight;var currentHeight=this.clientHeight;if(newHeight>currentHeight){this.style.height=newHeight+3*textLineHeight+"px"}}var setLineHeight=(lh)?lh:12;var textLineHeight=element.currentStyle?element.currentStyle.lineHeight:getComputedStyle(element,null).lineHeight;textLineHeight=(textLineHeight.indexOf("px")==-1)?setLineHeight:parseInt(textLineHeight,10);element.style.overflow="hidden";element.addEventListener?element.addEventListener("keyup",handler,false):element.attachEvent("onkeyup",handler)};MBP.enableActive=function(){document.addEventListener("touchstart",function(){},false)};MBP.preventScrolling=function(){document.addEventListener("touchmove",function(e){e.preventDefault()},false)};MBP.preventZoom=function(){var formFields=document.querySelectorAll("input, select, textarea");var contentString="width=device-width,initial-scale=1,maximum-scale=";var i=0;for(i=0;i<formFields.length;i++){formFields[i].onfocus=function(){MBP.viewportmeta.content=contentString+"1"};formFields[i].onblur=function(){MBP.viewportmeta.content=contentString+"10"}}};MBP.startupImage=function(){var portrait;var landscape;var pixelRatio;var head;var link1;var link2;pixelRatio=window.devicePixelRatio;head=document.getElementsByTagName("head")[0];if(navigator.platform==="iPad"){portrait=pixelRatio===2?"images/mobile/splash-1536x2008-retina.png":"images/mobile/splash-768x1004.png";landscape=pixelRatio===2?"images/mobile/splash-2048x1496-retina.png":"images/mobile/splash-1024x748.png";link1=document.createElement("link");link1.setAttribute("rel","apple-touch-startup-image");link1.setAttribute("media","screen and (orientation: portrait)");link1.setAttribute("href",portrait);head.appendChild(link1);link2=document.createElement("link");link2.setAttribute("rel","apple-touch-startup-image");link2.setAttribute("media","screen and (orientation: landscape)");link2.setAttribute("href",landscape);head.appendChild(link2)}else{portrait=pixelRatio===2?"images/mobile/splash-320x460-retina.png":"images/mobile/splash-320x460.png";link1=document.createElement("link");link1.setAttribute("rel","apple-touch-startup-image");link1.setAttribute("href",portrait);head.appendChild(link1)}}})(document);(function(document,navigator,standalone){if((standalone in navigator)&&navigator[standalone]){var curnode,location=document.location,stop=/^(a|html)$/i;document.addEventListener("click",function(e){curnode=e.target;while(!(stop).test(curnode.nodeName)){curnode=curnode.parentNode}if("href" in curnode&&(chref=curnode.href).replace(location.href,"").indexOf("#")&&(!(/^[a-z\+\.\-]+:/i).test(chref)||chref.indexOf(location.protocol+"//"+location.host)===0)){e.preventDefault();location.href=curnode.href}},false)}})(document,window.navigator,"standalone");