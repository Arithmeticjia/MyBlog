(function(a){var b={init:function(b){b=a.extend({},a.fn.ctAccordion.defaults,b);return this.each(function(){var c=a(this).addClass(b.myClass).data("ctAccordion",{options:b});var d=1;a("ul",c).each(function(){a(this).data("ctAccordion",{numID:d++})}).find("li").addClass(b.collapsedPathClass);c.find("ul").hide();a(b.defaultExpanded,c).each(function(){a(this).removeClass(b.collapsedPathClass)}).parents("li").addClass(b.expandedPathClass).removeClass(b.collapsedPathClass);if(a(b.defaultExpanded,c).length){f.apply(c,[a(b.defaultExpanded,c)])}a("a + ul",c).prev("a").addClass(b.headerClass).bind(b.event,function(){if(a(this).next("ul").is(":not(:hidden)")){e.apply(c,[a(this)])}else{f.apply(c,[a(this),b.oneOpenAtTime])}return false})});return this},search:function(b){var c=a(this),e=c.data("ctAccordion"),g=e.options,h=new RegExp(b,"i");d.apply(c);a("li>a, >li>ul>li>ul>li",c).each(function(){var b=a(this).text().match(h);if(b!=""&&b!=null){var d=a(this);if(a(this)[0].nodeName=="LI"){d=a(this).closest("ul").prev("a")}f.apply(c,[d,false]);d.addClass(g.foundPhraseClass)}else{a(this).removeClass(g.foundPhraseClass)}});return this},open:function(b,c){var d=a(this),e=d.data("ctAccordion"),g=e.options;b--;return a(this).each(function(){if(b<0){return}var e=a(">li>a",d);if(b>e.length){return}var h=e.eq(b);f.apply(d,[h,g.oneOpenAtTime]);if(c!=undefined){c--;$level2=h.next("ul").find(">li>a");if(c<0||c>$level2.length){return}var h=$level2.eq(c);f.apply(d,[h,g.oneOpenAtTime])}})},option:function(b,c){if(typeof b==="string"){if(c===undefined){var d=a(this),e=d.data("ctAccordion");return e.options[b]}else{var d=a(this),e=d.data("ctAccordion");e.options[b]=c;d.data("ctAccordion",e);return this}}}};var c=function(b){var c=[];b.parents("ul").each(function(b,d){var e=a(d).data("ctAccordion");var b=parseInt(e.numID);if(!isNaN(b)){c.push(b)}});return c};var d=function(b){var d=a(this),f=d.data("ctAccordion"),g=f.options;if(b===undefined){e.apply(d,[a("li."+g.expandedPathClass+" > a."+g.headerClass)])}else{var h=c(b);a("ul:visible",d).each(function(b,c){var f=a(c),i=f.data("ctAccordion");var j=parseInt(i.numID);if(a.inArray(j,h)==-1){e.apply(d,[a(f.prev("."+g.headerClass)[0])])}})}};var e=function(b){var c=a(this),d=c.data("ctAccordion"),e=d.options;e.onClose.apply(c,[b]);b.nextAll("ul").slideUp("fast").find("li").removeClass(e.expandedPathClass).addClass(e.collapsedPathClass);b.closest("li").removeClass(e.expandedPathClass).addClass(e.collapsedPathClass)};var f=function(b,c){if(c===undefined||c==true){d.apply(a(this),[b])}var e=a(this),f=e.data("ctAccordion"),h=f.options;h.onOpen.apply(e,[b]);b.nextAll("ul").slideDown(h.speed,h.easing);g.apply(a(this),[b.closest("li")])};var g=function(b){var c=a(this),d=c.data("ctAccordion"),e=d.options;b.addClass(e.expandedPathClass).removeClass(e.collapsedPathClass);var f=b.closest("ul").slideDown("fast");if(f.length==0){return}var h=f.closest("li");if(h.length>0){g.apply(c,[a(h[0])])}return};a.fn.ctAccordion=function(c){if(b[c]){return b[c].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof c==="object"||!c){b.init.apply(this,arguments)}else{a.error("Method "+c+" does not exist on 3 Level Accordion!")}};a.fn.ctAccordion.defaults={headerClass:"head",defaultExpanded:".expanded",expandedPathClass:"open",collapsedPathClass:"closed",foundPhraseClass:"searchMatch",event:"click",myClass:"ctAccordion",oneOpenAtTime:true,easing:"linear",speed:200,onOpen:a.noop,onClose:a.noop}})(jQuery)